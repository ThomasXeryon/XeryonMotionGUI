<UserControl
    x:Class="XeryonMotionGUI.DraggableElement"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:XeryonMotionGUI"
    xmlns:helpers="using:XeryonMotionGUI.Helpers">

    <UserControl.Resources>
        <helpers:NullToBooleanConverter x:Key="NullToBooleanConverter" />
        <helpers:WaitBlockToVisibilityConverter x:Key="WaitBlockToVisibilityConverter" />
        <helpers:RepeatBlockToVisibilityConverter x:Key="RepeatBlockToVisibilityConverter" />
        <helpers:StringToIntConverter x:Key="StringToIntConverter" />
    </UserControl.Resources>

    <Grid>
        <Border 
            x:Name="BlockBorder"
            CornerRadius="5" 
            Padding="10" 
            Background="LightGray" 
            BorderThickness="1" 
            BorderBrush="Black"
            Width="150" 
            IsHitTestVisible="True">
            <!-- Ensure the Border is hittable -->
            <StackPanel>
                <!-- Block Text -->
                <TextBlock 
                    Text="{Binding Text}" 
                    FontWeight="Bold" 
                    Margin="0,0,0,5" 
                    HorizontalAlignment="Center" />
                <!-- Center the text -->

                <!-- Wait Time Input (Visible only for Wait block) -->
                <NumberBox
    x:Name="WaitTimeInput"
    Header="Wait time (ms)"
    Value="{Binding WaitTime, Mode=TwoWay}"
    SpinButtonPlacementMode="Inline"
    SmallChange="100"
    LargeChange="1000"
    Margin="0,5,0,5"
    Visibility="{Binding Text, Converter={StaticResource WaitBlockToVisibilityConverter}}"
    ValueChanged="WaitTimeInput_ValueChanged" />
                <NumberBox
    x:Name="RepeatCountInput"
    Header="Repeat Count"
    Value="{Binding RepeatCount, Mode=TwoWay}"
    SpinButtonPlacementMode="Inline"
    SmallChange="1"
    LargeChange="5"
    Minimum="1"
    Margin="0,5,0,5"
    ValueChanged="RepeatInput_ValueChanged"
    Visibility="{Binding Text, Converter={StaticResource RepeatBlockToVisibilityConverter}}" />

                <!-- Controller Selection -->
                <ComboBox 
                    ItemsSource="{Binding RunningControllers}" 
                    SelectedItem="{Binding SelectedController, Mode=TwoWay}"
                    DisplayMemberPath="FriendlyName"
                    Margin="0,5,0,5"
                    PlaceholderText="Select Controller" />

                <!-- Axis Selection -->
                <ComboBox 
                    ItemsSource="{Binding SelectedController.Axes}" 
                    SelectedItem="{Binding SelectedAxis, Mode=TwoWay}"
                    DisplayMemberPath="FriendlyName"
                    Margin="0,5,0,5"
                    PlaceholderText="Select Axis"
                    IsEnabled="{Binding SelectedController, Converter={StaticResource NullToBooleanConverter}}" />
            </StackPanel>
        </Border>
    </Grid>
</UserControl>